<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 4 GraphQL: Objects | GraphQL workshop for NodeJS developers</title>
  <meta name="description" content="Chapter 4 GraphQL: Objects | GraphQL workshop for NodeJS developers">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 4 GraphQL: Objects | GraphQL workshop for NodeJS developers" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 4 GraphQL: Objects | GraphQL workshop for NodeJS developers" />
  <meta name="github-repo" content="wesovilabs-workshops/workshop-graphql-nodejs-guide" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 GraphQL: Objects | GraphQL workshop for NodeJS developers" />
  
  <meta name="twitter:description" content="Chapter 4 GraphQL: Objects | GraphQL workshop for NodeJS developers" />
  

<meta name="author" content="Iván Corrales Solera ivan.corrales.solera@gmail.com">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="the-graphql-playground.html">
<link rel="next" href="graphql-operations.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-135460737-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'UA-135460737-1');
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">GraphQL for NodeJS developers</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Pre-requisites</a></li>
<li class="chapter" data-level="2" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html"><i class="fa fa-check"></i><b>2</b> Set up your environment</a><ul>
<li class="chapter" data-level="2.1" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html#download-the-project"><i class="fa fa-check"></i><b>2.1</b> Download the project</a></li>
<li class="chapter" data-level="2.2" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html#project-structure"><i class="fa fa-check"></i><b>2.2</b> Project structure</a></li>
<li class="chapter" data-level="2.3" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html#running-the-server"><i class="fa fa-check"></i><b>2.3</b> Running the server</a><ul>
<li class="chapter" data-level="2.3.1" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html#while-youre-coding"><i class="fa fa-check"></i><b>2.3.1</b> While you’re coding</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html#workshop-application"><i class="fa fa-check"></i><b>2.4</b> Workshop Application</a><ul>
<li class="chapter" data-level="2.4.1" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html#database"><i class="fa fa-check"></i><b>2.4.1</b> Database</a></li>
<li class="chapter" data-level="2.4.2" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html#api"><i class="fa fa-check"></i><b>2.4.2</b> API</a></li>
<li class="chapter" data-level="2.4.3" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html#graphql-schema"><i class="fa fa-check"></i><b>2.4.3</b> GraphQL schema</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-graphql-playground.html"><a href="the-graphql-playground.html"><i class="fa fa-check"></i><b>3</b> The GraphQL Playground</a><ul>
<li class="chapter" data-level="3.1" data-path="the-graphql-playground.html"><a href="the-graphql-playground.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="the-graphql-playground.html"><a href="the-graphql-playground.html#graphql-syntax"><i class="fa fa-check"></i><b>3.2</b> GraphQL syntax</a></li>
<li class="chapter" data-level="3.3" data-path="the-graphql-playground.html"><a href="the-graphql-playground.html#challenges"><i class="fa fa-check"></i><b>3.3</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="graphql-objects.html"><a href="graphql-objects.html"><i class="fa fa-check"></i><b>4</b> GraphQL: Objects</a><ul>
<li class="chapter" data-level="4.1" data-path="graphql-objects.html"><a href="graphql-objects.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="graphql-objects.html"><a href="graphql-objects.html#code"><i class="fa fa-check"></i><b>4.2</b> Code</a><ul>
<li class="chapter" data-level="4.2.1" data-path="graphql-objects.html"><a href="graphql-objects.html#resolvers"><i class="fa fa-check"></i><b>4.2.1</b> Resolvers</a></li>
<li class="chapter" data-level="4.2.2" data-path="graphql-objects.html"><a href="graphql-objects.html#scalars"><i class="fa fa-check"></i><b>4.2.2</b> Scalars</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="graphql-objects.html"><a href="graphql-objects.html#challenges-1"><i class="fa fa-check"></i><b>4.3</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphql-operations.html"><a href="graphql-operations.html"><i class="fa fa-check"></i><b>5</b> GraphQL: Operations</a><ul>
<li class="chapter" data-level="5.1" data-path="graphql-operations.html"><a href="graphql-operations.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="graphql-operations.html"><a href="graphql-operations.html#code-1"><i class="fa fa-check"></i><b>5.2</b> Code</a></li>
<li class="chapter" data-level="5.3" data-path="graphql-operations.html"><a href="graphql-operations.html#challenges-2"><i class="fa fa-check"></i><b>5.3</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="graphql-interfaces-and-unions.html"><a href="graphql-interfaces-and-unions.html"><i class="fa fa-check"></i><b>6</b> GraphQL: Interfaces and Unions</a><ul>
<li class="chapter" data-level="6.1" data-path="graphql-interfaces-and-unions.html"><a href="graphql-interfaces-and-unions.html#introduction-3"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="graphql-interfaces-and-unions.html"><a href="graphql-interfaces-and-unions.html#fragments"><i class="fa fa-check"></i><b>6.2</b> Fragments</a></li>
<li class="chapter" data-level="6.3" data-path="graphql-interfaces-and-unions.html"><a href="graphql-interfaces-and-unions.html#code-2"><i class="fa fa-check"></i><b>6.3</b> Code</a></li>
<li class="chapter" data-level="6.4" data-path="graphql-interfaces-and-unions.html"><a href="graphql-interfaces-and-unions.html#challenges-3"><i class="fa fa-check"></i><b>6.4</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="graphql-directives.html"><a href="graphql-directives.html"><i class="fa fa-check"></i><b>7</b> GraphQL: Directives</a><ul>
<li class="chapter" data-level="7.1" data-path="graphql-directives.html"><a href="graphql-directives.html#introduction-4"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="graphql-directives.html"><a href="graphql-directives.html#code-3"><i class="fa fa-check"></i><b>7.2</b> Code</a></li>
<li class="chapter" data-level="7.3" data-path="graphql-directives.html"><a href="graphql-directives.html#challenges-4"><i class="fa fa-check"></i><b>7.3</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="challenges-solution.html"><a href="challenges-solution.html"><i class="fa fa-check"></i><b>8</b> Challenges Solution</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://twitter.com/wesovilabs" target="blank">By Ivan Corrales Solera</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GraphQL workshop for NodeJS developers</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graphql-objects" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> GraphQL: Objects</h1>
<div id="introduction-1" class="section level2">
<h2><span class="header-section-number">4.1</span> Introduction</h2>
<p>The GraphQL specification includes the following default scalar types: Int, Float, String, Boolean and ID. While this covers most of the use cases, often you need to support custom atomic data types (e.g. Date), or you want a version of an existing type that does some validation. To enable this, GraphQL allows you to define custom scalar types. Enumerations are similar to custom scalars, but their values can only be one of a pre-defined list of strings.</p>
<p>The way to define new scalars or enums in the schema is shown below:</p>
<pre class="graphql"><code>scalar MyCustomScalar

enum Direction {
  NORTH
  EAST
  SOUTH
  WEST
}

type MyType {
    myAttribute: MyCustomScalar
    direction: Direction
    ...
}
</code></pre>
<p>Fields can take arguments as input. These can be used to customize the return value (eg, filtering search results). This is known as <strong>field argument</strong>.</p>
<p>If you have a look at our schema.graphql you can find an example of usage of a field argument for attribute actors in type Movie. The total argument is used to define the max number of actors returned from the server.</p>
</div>
<div id="code" class="section level2">
<h2><span class="header-section-number">4.2</span> Code</h2>
<div id="resolvers" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Resolvers</h3>
<p>Let’s imagine that we have an operation that returns a Employee type and this type contains an attribute details of type SocialDetails whose information needs to be taken from an external API. And this attribute won’t be always required by the API consumers. Server should not waste time on obtaining something that clients do not need.</p>
<p><strong>src/resolvers.js</strong></p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="im">export</span> <span class="im">default</span> <span class="op">{</span>
    <span class="dt">Person</span><span class="op">:</span> <span class="op">{</span>
        <span class="dt">details</span><span class="op">:</span> <span class="at">async</span> (<span class="op">{</span>personId<span class="op">}</span>) <span class="op">=&gt;</span> <span class="op">{</span>
            <span class="cf">return</span> await <span class="at">getDetailsFromLinkedin</span>(personId)
        <span class="op">},</span>
    <span class="op">}</span>
    
<span class="op">}</span></code></pre></div>
<p>Now, image that SocialDetails can be taken from more than one social network and we want to permit the consumers to decide which social network must be used.</p>
<p><strong>resources/graphql/schema.graphql.</strong></p>
<pre class="graphl"><code>enum Source{
    Linkedin
    Facebook
}
type Person {

  details(source:Source=Linkedin):SocialDetails
}
</code></pre>
<p>Our resolver would look like this example:</p>
<p><strong>src/resolvers.js</strong></p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="im">export</span> <span class="im">default</span> <span class="op">{</span>
    <span class="dt">Person</span><span class="op">:</span> <span class="op">{</span>
        <span class="dt">details</span><span class="op">:</span> <span class="at">async</span> (<span class="op">{</span>personId<span class="op">},{</span>source<span class="op">}</span>) <span class="op">=&gt;</span> <span class="op">{</span>
            <span class="cf">if</span> (source <span class="op">===</span> <span class="st">&#39;Linkedin&#39;</span>)<span class="op">{</span>
                <span class="cf">return</span> await <span class="at">getDetailsFromLinkedin</span>(personId)    
            <span class="op">}</span>
            <span class="cf">return</span> await <span class="at">getDetailsFromFacebook</span>(personId)
        <span class="op">},</span>
    <span class="op">}</span>
    
<span class="op">}</span></code></pre></div>
</div>
<div id="scalars" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Scalars</h3>
<p>The library <strong>graphql</strong> provides us with class <strong>GraphQLScalarType</strong>. We just need to create a new instance an add it as a new resolver. An example of scalar type is shown below:</p>
<p><strong>src/scalars.js</strong></p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="im">import</span> <span class="op">{</span>GraphQLScalarType<span class="op">}</span> <span class="im">from</span> <span class="st">&#39;graphql&#39;</span><span class="op">;</span>

<span class="kw">var</span> OddType <span class="op">=</span> <span class="kw">new</span> <span class="at">GraphQLScalarType</span>(<span class="op">{</span>
  <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;Odd&#39;</span><span class="op">,</span>
  <span class="dt">serialize</span><span class="op">:</span> oddValue<span class="op">,</span>
  <span class="dt">parseValue</span><span class="op">:</span> oddValue<span class="op">,</span>
  <span class="at">parseLiteral</span>(ast) <span class="op">{</span>
    <span class="cf">if</span> (<span class="va">ast</span>.<span class="at">kind</span> <span class="op">===</span> <span class="va">Kind</span>.<span class="at">INT</span>) <span class="op">{</span>
      <span class="cf">return</span> <span class="at">oddValue</span>(<span class="at">parseInt</span>(<span class="va">ast</span>.<span class="at">value</span><span class="op">,</span> <span class="dv">10</span>))<span class="op">;</span>
    <span class="op">}</span>
    <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span>
  <span class="op">}</span>
<span class="op">}</span>)<span class="op">;</span>

<span class="kw">function</span> <span class="at">oddValue</span>(value) <span class="op">{</span>
  <span class="cf">return</span> value <span class="op">%</span> <span class="dv">2</span> <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> value : <span class="kw">null</span><span class="op">;</span>
<span class="op">}</span></code></pre></div>
<p><strong>src/schema.js</strong></p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="im">export</span> <span class="im">default</span> <span class="at">makeExecutableSchema</span>(<span class="op">{</span>
    <span class="dt">resolvers</span><span class="op">:</span> <span class="op">{</span>
        <span class="dt">Odd</span><span class="op">:</span> OddType
    <span class="op">}</span>
<span class="op">}</span>)</code></pre></div>
<p>Have a look <a href="https://graphql.org/graphql-js/type/#graphqlscalartype">here</a> to learn more about how to implement custom scalars with gaphql-js.</p>
</div>
</div>
<div id="challenges-1" class="section level2">
<h2><span class="header-section-number">4.3</span> Challenges</h2>
<ol style="list-style-type: decimal">
<li>Define an enum type Genre whose values are Drama and SciFi (add as many other as you want) and use it for attribute genre in type Movie and MovieRequest.</li>
</ol>
<p>Run this query to verify your implementation works as expected</p>
<pre class="graphql"><code>mutation {
  addMovie (request:{
    title: &quot;Corpse Bride&quot;
    year: 2005
    budget: 35000000
    directorId: 1
    genre: SciFi
    thriller: &quot;https://www.youtube.com/watch?v=o5qOjhD8j08&quot;
  }){
    id
    director{
      fullName
      country
    }
    genre
  }
}</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Define an enum Gender and use it for attribute gender in type Actor.</li>
</ol>
<p>Run this query to verify your implementation works as expected</p>
<pre class="graphql"><code>query {
  listActors{
    fullName
    gender
  }
}</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Define a scalar type Url and use it in attribute thriller of Movie and MovieRequest. Only valid url’s should be permitted.</li>
</ol>
<p>Run this query to verify that only valid url’s are permitted. Actually, the movies should not be saved into the database.</p>
<pre class="graphql"><code>mutation {
  addMovie (request:{
    title: &quot;Gran Torino&quot;
    year: 2009
    budget: 28000000
    directorId: 6
    genre: Drama
    thriller: &quot;.http&quot;
  }){
    id
    director{
      fullName
      country
    }
    genre
    thriller
  }
}</code></pre>
<p>Run this query to verify that your scalar Url works as expected.</p>
<pre class="graphql"><code>mutation {
  addMovie (request:{
    title: &quot;Gran Torino&quot;
    year: 2009
    budget: 28000000
    directorId: 6
    genre: Drama
    thriller: &quot;https://www.youtube.com/watch?v=9ecW-d-CBPc&quot;
  }){
    id
    director{
      fullName
      country
    }
    genre
    thriller
  }
}</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Define an enum type Currency whose possible values are Euro and Dollar. Our API must permit the API consumers to decide in which currency they want to obtain attribute budget in type Movie. <strong>1€ =&gt; 1.14$</strong></li>
</ol>
<p>Run this query</p>
<pre class="graphql"><code>query {
  getMovie(movieId:1){
    budgetInEuros: budget(currency:Euro)
    budgetInDollarts: budget(currency:Dollar)
  }
}</code></pre>
<p>and verify that the output should be this:</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;data&quot;</span><span class="fu">:</span> <span class="fu">{</span>
    <span class="dt">&quot;getMovie&quot;</span><span class="fu">:</span> <span class="fu">{</span>
      <span class="dt">&quot;budgetInEuros&quot;</span><span class="fu">:</span> <span class="dv">20</span><span class="fu">,</span>
      <span class="dt">&quot;budgetInDollarts&quot;</span><span class="fu">:</span> <span class="fl">22.799999999999997</span>
    <span class="fu">}</span>
  <span class="fu">}</span>
<span class="fu">}</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-graphql-playground.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="graphql-operations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["workshop-graphql-nodejs.pdf", "workshop-graphql-nodejs.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
