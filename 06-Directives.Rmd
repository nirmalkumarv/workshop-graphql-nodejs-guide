# GraphQL: Directives

## Introduction

A GraphQL schema describes directives which are used to annotate various parts of a GraphQL document as an indicator that 
they should be evaluated differently by a validator, executor, or client tool such as a code generator.
GraphQL implementations should provide the @skip and @include directives.
GraphQL implementations that support the type system definition language must provide the  @deprecated directive if 
representing deprecated portions of the schema.
Directives must only be used in the locations they are declared to belong in. In this example, a directive is defined 
which can be used to annotate a field: [facebook.github.io/graphql](https://facebook.github.io/graphql/draft/#sec-Type-System.Directives) 

Authorization is a good and common scenario in which we usually will make use of directives. We could control what
users are allowd to fetch an object (or even an attribute) from the server.

```graphql

directive @isAuthenticated on FIELD | FIELD_DEFINITION
directive @hasRole(role: String) on FIELD | FIELD_DEFINITION


```

or for clients tools as It was mentioned on the above paragraph.

```graphql
directive @deprecated(
  reason: String = "No longer supported"
) on FIELD_DEFINITION | ENUM_VALUE


type ExampleType {
  newField: String
  oldField: String @deprecated(reason: "Use `newField`.")
}

```


## Code

When defining a directive we need to define its scope. Have a look at [apollographql.com](https://www.apollographql.com/docs/graphql-tools/schema-directives.html) to understand
how to implement our own directives.

Below a very basic example of directive.

**directives.js**
```js
import { SchemaDirectiveVisitor } from "graphql-tools";

class DeprecatedDirective extends SchemaDirectiveVisitor {
  
  visitFieldDefinition(field) {
    field.isDeprecated = true;
    field.deprecationReason = this.args.reason;
  }

  visitEnumValue(value) {
    value.isDeprecated = true;
    value.deprecationReason = this.args.reason;
  }
}
```

Once we've implemented the directive ,  we just need to add the directives as shown below:

**src/schema.js**
```js
export default makeExecutableSchema({
    typeDefs,
    resolvers,
    schemaDirectives: {
        dreprecated: DeprecatedDirective,
        
    },
    ...
});
```

## Challenges

1. Create a directive @uppercase that can be assigned to fields. This directive will transform the value of the attribute
into uppercase. The directive declaration will look lie this

```graphql
directive @uppercase on FIELD_DEFINITION

"""Movie details"""
type Movie {
    ...
    title: String! @uppercase
    ...
}

```  

To verify the directive was implemented correctly we can run

```graphql
query {
  listMovies{
    title
  }
}
```

and check that the title for all the movies was returned in uppercase.

```json
{
  "data": {
    "listMovies": [
      {
        "title": "EDWARD SCISSORHANDS"
      },
      {
        "title": "GLADIATOR"
      }
    ]
  }
}
```