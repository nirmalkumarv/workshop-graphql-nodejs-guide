<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 7 GraphQL: Directives | GraphQL workshop for NodeJS developers</title>
  <meta name="description" content="Chapter 7 GraphQL: Directives | GraphQL workshop for NodeJS developers">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 7 GraphQL: Directives | GraphQL workshop for NodeJS developers" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 7 GraphQL: Directives | GraphQL workshop for NodeJS developers" />
  <meta name="github-repo" content="wesovilabs-workshops/workshop-graphql-nodejs-guide" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 GraphQL: Directives | GraphQL workshop for NodeJS developers" />
  
  <meta name="twitter:description" content="Chapter 7 GraphQL: Directives | GraphQL workshop for NodeJS developers" />
  

<meta name="author" content="Iván Corrales Solera ivan.corrales.solera@gmail.com">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="graphql-interfaces-and-unions.html">
<link rel="next" href="challenges-solution.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-135460737-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'UA-135460737-1');
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">GraphQL for NodeJS developers</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Pre-requisites</a></li>
<li class="chapter" data-level="2" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html"><i class="fa fa-check"></i><b>2</b> Set up your environment</a><ul>
<li class="chapter" data-level="2.1" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html#download-the-project"><i class="fa fa-check"></i><b>2.1</b> Download the project</a></li>
<li class="chapter" data-level="2.2" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html#project-structure"><i class="fa fa-check"></i><b>2.2</b> Project structure</a></li>
<li class="chapter" data-level="2.3" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html#running-the-server"><i class="fa fa-check"></i><b>2.3</b> Running the server</a><ul>
<li class="chapter" data-level="2.3.1" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html#while-youre-coding"><i class="fa fa-check"></i><b>2.3.1</b> While you’re coding</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html#workshop-application"><i class="fa fa-check"></i><b>2.4</b> Workshop Application</a><ul>
<li class="chapter" data-level="2.4.1" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html#database"><i class="fa fa-check"></i><b>2.4.1</b> Database</a></li>
<li class="chapter" data-level="2.4.2" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html#api"><i class="fa fa-check"></i><b>2.4.2</b> API</a></li>
<li class="chapter" data-level="2.4.3" data-path="set-up-your-environment.html"><a href="set-up-your-environment.html#graphql-schema"><i class="fa fa-check"></i><b>2.4.3</b> GraphQL schema</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-graphql-playground.html"><a href="the-graphql-playground.html"><i class="fa fa-check"></i><b>3</b> The GraphQL Playground</a><ul>
<li class="chapter" data-level="3.1" data-path="the-graphql-playground.html"><a href="the-graphql-playground.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="the-graphql-playground.html"><a href="the-graphql-playground.html#graphql-syntax"><i class="fa fa-check"></i><b>3.2</b> GraphQL syntax</a></li>
<li class="chapter" data-level="3.3" data-path="the-graphql-playground.html"><a href="the-graphql-playground.html#challenges"><i class="fa fa-check"></i><b>3.3</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="graphql-objects.html"><a href="graphql-objects.html"><i class="fa fa-check"></i><b>4</b> GraphQL: Objects</a><ul>
<li class="chapter" data-level="4.1" data-path="graphql-objects.html"><a href="graphql-objects.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="graphql-objects.html"><a href="graphql-objects.html#code"><i class="fa fa-check"></i><b>4.2</b> Code</a><ul>
<li class="chapter" data-level="4.2.1" data-path="graphql-objects.html"><a href="graphql-objects.html#resolvers"><i class="fa fa-check"></i><b>4.2.1</b> Resolvers</a></li>
<li class="chapter" data-level="4.2.2" data-path="graphql-objects.html"><a href="graphql-objects.html#scalars"><i class="fa fa-check"></i><b>4.2.2</b> Scalars</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="graphql-objects.html"><a href="graphql-objects.html#challenges-1"><i class="fa fa-check"></i><b>4.3</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphql-operations.html"><a href="graphql-operations.html"><i class="fa fa-check"></i><b>5</b> GraphQL: Operations</a><ul>
<li class="chapter" data-level="5.1" data-path="graphql-operations.html"><a href="graphql-operations.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="graphql-operations.html"><a href="graphql-operations.html#code-1"><i class="fa fa-check"></i><b>5.2</b> Code</a></li>
<li class="chapter" data-level="5.3" data-path="graphql-operations.html"><a href="graphql-operations.html#challenges-2"><i class="fa fa-check"></i><b>5.3</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="graphql-interfaces-and-unions.html"><a href="graphql-interfaces-and-unions.html"><i class="fa fa-check"></i><b>6</b> GraphQL: Interfaces and Unions</a><ul>
<li class="chapter" data-level="6.1" data-path="graphql-interfaces-and-unions.html"><a href="graphql-interfaces-and-unions.html#introduction-3"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="graphql-interfaces-and-unions.html"><a href="graphql-interfaces-and-unions.html#fragments"><i class="fa fa-check"></i><b>6.2</b> Fragments</a></li>
<li class="chapter" data-level="6.3" data-path="graphql-interfaces-and-unions.html"><a href="graphql-interfaces-and-unions.html#code-2"><i class="fa fa-check"></i><b>6.3</b> Code</a></li>
<li class="chapter" data-level="6.4" data-path="graphql-interfaces-and-unions.html"><a href="graphql-interfaces-and-unions.html#challenges-3"><i class="fa fa-check"></i><b>6.4</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="graphql-directives.html"><a href="graphql-directives.html"><i class="fa fa-check"></i><b>7</b> GraphQL: Directives</a><ul>
<li class="chapter" data-level="7.1" data-path="graphql-directives.html"><a href="graphql-directives.html#introduction-4"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="graphql-directives.html"><a href="graphql-directives.html#code-3"><i class="fa fa-check"></i><b>7.2</b> Code</a></li>
<li class="chapter" data-level="7.3" data-path="graphql-directives.html"><a href="graphql-directives.html#challenges-4"><i class="fa fa-check"></i><b>7.3</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="challenges-solution.html"><a href="challenges-solution.html"><i class="fa fa-check"></i><b>8</b> Challenges Solution</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://twitter.com/wesovilabs" target="blank">By Ivan Corrales Solera</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GraphQL workshop for NodeJS developers</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graphql-directives" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> GraphQL: Directives</h1>
<div id="introduction-4" class="section level2">
<h2><span class="header-section-number">7.1</span> Introduction</h2>
<p>A GraphQL schema describes directives which are used to annotate various parts of a GraphQL document as an indicator that they should be evaluated differently by a validator, executor, or client tool such as a code generator. GraphQL implementations should provide the <span class="citation">@skip</span> and <span class="citation">@include</span> directives. GraphQL implementations that support the type system definition language must provide the <span class="citation">@deprecated</span> directive if representing deprecated portions of the schema. Directives must only be used in the locations they are declared to belong in. In this example, a directive is defined which can be used to annotate a field: <a href="https://facebook.github.io/graphql/draft/#sec-Type-System.Directives">facebook.github.io/graphql</a></p>
<p>Authorization is a good and common scenario in which we usually will make use of directives. We could control what users are allowd to fetch an object (or even an attribute) from the server.</p>
<pre class="graphql"><code>
directive @isAuthenticated on FIELD | FIELD_DEFINITION
directive @hasRole(role: String) on FIELD | FIELD_DEFINITION

</code></pre>
<p>or for clients tools as It was mentioned on the above paragraph.</p>
<pre class="graphql"><code>directive @deprecated(
  reason: String = &quot;No longer supported&quot;
) on FIELD_DEFINITION | ENUM_VALUE


type ExampleType {
  newField: String
  oldField: String @deprecated(reason: &quot;Use `newField`.&quot;)
}
</code></pre>
</div>
<div id="code-3" class="section level2">
<h2><span class="header-section-number">7.2</span> Code</h2>
<p>When defining a directive we need to define its scope. Have a look at <a href="https://www.apollographql.com/docs/graphql-tools/schema-directives.html">apollographql.com</a> to understand how to implement our own directives.</p>
<p>Below a very basic example of directive.</p>
<p><strong>directives.js</strong></p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="im">import</span> <span class="op">{</span> SchemaDirectiveVisitor <span class="op">}</span> <span class="im">from</span> <span class="st">&quot;graphql-tools&quot;</span><span class="op">;</span>

<span class="kw">class</span> DeprecatedDirective <span class="kw">extends</span> SchemaDirectiveVisitor <span class="op">{</span>
  
  <span class="at">visitFieldDefinition</span>(field) <span class="op">{</span>
    <span class="va">field</span>.<span class="at">isDeprecated</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span>
    <span class="va">field</span>.<span class="at">deprecationReason</span> <span class="op">=</span> <span class="kw">this</span>.<span class="va">args</span>.<span class="at">reason</span><span class="op">;</span>
  <span class="op">}</span>

  <span class="at">visitEnumValue</span>(value) <span class="op">{</span>
    <span class="va">value</span>.<span class="at">isDeprecated</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span>
    <span class="va">value</span>.<span class="at">deprecationReason</span> <span class="op">=</span> <span class="kw">this</span>.<span class="va">args</span>.<span class="at">reason</span><span class="op">;</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>Once we’ve implemented the directive , we just need to add the directives as shown below:</p>
<p><strong>src/schema.js</strong></p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="im">export</span> <span class="im">default</span> <span class="at">makeExecutableSchema</span>(<span class="op">{</span>
    typeDefs<span class="op">,</span>
    resolvers<span class="op">,</span>
    <span class="dt">schemaDirectives</span><span class="op">:</span> <span class="op">{</span>
        <span class="dt">dreprecated</span><span class="op">:</span> DeprecatedDirective<span class="op">,</span>
        
    <span class="op">},</span>
    ...
<span class="op">}</span>)<span class="op">;</span></code></pre></div>
</div>
<div id="challenges-4" class="section level2">
<h2><span class="header-section-number">7.3</span> Challenges</h2>
<ol style="list-style-type: decimal">
<li>Create a directive <span class="citation">@uppercase</span> that can be assigned to fields. This directive will transform the value of the attribute into uppercase. The directive declaration will look lie this</li>
</ol>
<pre class="graphql"><code>directive @uppercase on FIELD_DEFINITION

&quot;&quot;&quot;Movie details&quot;&quot;&quot;
type Movie {
    ...
    title: String! @uppercase
    ...
}
</code></pre>
<p>To verify the directive was implemented correctly we can run</p>
<pre class="graphql"><code>query {
  listMovies{
    title
  }
}</code></pre>
<p>and check that the title for all the movies was returned in uppercase.</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;data&quot;</span><span class="fu">:</span> <span class="fu">{</span>
    <span class="dt">&quot;listMovies&quot;</span><span class="fu">:</span> <span class="ot">[</span>
      <span class="fu">{</span>
        <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;EDWARD SCISSORHANDS&quot;</span>
      <span class="fu">}</span><span class="ot">,</span>
      <span class="fu">{</span>
        <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;GLADIATOR&quot;</span>
      <span class="fu">}</span>
    <span class="ot">]</span>
  <span class="fu">}</span>
<span class="fu">}</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="graphql-interfaces-and-unions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="challenges-solution.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["workshop-graphql-nodejs.pdf", "workshop-graphql-nodejs.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
